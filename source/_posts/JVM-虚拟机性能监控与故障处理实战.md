---
title: JVM-虚拟机性能监控与故障处理实战
date: 2020-05-04 17:53:58
tags: JVM
---

本文主要介绍如何应用一些虚拟机的性能监控和分析的命令。

## jdk命令行工具

### jps

![image-20200504175625119](/images/image-20200504175625119.png)

jps可以查看当前jvm运行的进程名和它们对应的虚拟机进程号。查到进程号后方便结合后续的很多其他命令。



### jstat

jstat用于监视虚拟机各种运行状态信息，显示**类装载、内存、垃圾收集、JIT编译**等运行数据。

![image-20200504175926715](/images/image-20200504175926715.png)

表示分析进程 id 为 8608 的 gc 情况，每隔 1000ms 打印一次记录，不停止。



### jinfo

jinfo用于**实时查看和调整虚拟机各项参数**。

![image-20200504180217340](/images/image-20200504180217340.png)

带参数的jinfo

![image-20200504180250530](/images/image-20200504180250530.png)



### jmap

用于**生成堆转储快照**。

![image-20200504180359885](/images/image-20200504180359885.png)



### jhat

用于**分析堆转储快照**。使用jhat，用户可以在浏览器上查看分析结果。

![image-20200504180455772](/images/image-20200504180455772.png)

进入localhost:7070:

![image-20200504180509345](/images/image-20200504180509345.png)



### jstack

用于**生成虚拟机当前时刻的线程快照**。

主要目的是定位线程出现长时间停顿的原因， 如死锁、死循环、请求外部资源长时间等待.....

![持续等待用户输入造成停顿时间过长](/images/image-20200504180715612.png)

![jstack定位死锁](/images/image-20200504181116799.png)



## 可视化工具

### jconsole

可以在cmd窗口打开jconsole图形化工具，然后连接到本地进程或远程进程。

![image-20200504181849691](/images/image-20200504181849691.png)



### VisualVM

强大的运行监视和故障处理程序，可以在cmd窗口输入jvisualvm打开此图形化工具。

![image-20200504183707463](/images/image-20200504183707463.png)

![转储后分析内存](/images/image-20200504184212745.png)